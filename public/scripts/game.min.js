function solveSudoku(p,v){var v=v||{};v.easy=true;var h=JSON.parse(JSON.stringify(p));var x=[[],[],[],[],[],[],[],[],[]];for(var t=0;t<9;t++){for(var s=0;s<9;s++){x[t][s]=[false,true,true,true,true,true,true,true,true,true]}}var d=false;var c=false;var f=false;var r=false;var m=0;outerLoop:while(!d&&!c){d=true;f=false;m++;var n=[];var w=9;for(t=0;t<9;t++){for(s=0;s<9;s++){if(h[t][s]===0){d=false;var u=x[t][s];var g;var e;if(m===1){g=getZone(t)*3;e=getZone(s)*3;u[10]=g;u[11]=e}else{g=u[10];e=u[11]}var b=reducePossibilities(h,t,s,u,g,e);if(b){f=true}var o=0;var a=0;for(var q=1;q<=9;q++){if(u[q]){o++;a=q}}if(o===0){c=true;break outerLoop}else{if(o===1){h[t][s]=a;f=true;continue}}if(r){var l=checkFreedoms(h,t,s,x,g,e);if(l!==0){h[t][s]=l;f=true;continue}if(o===w){n.push([t,s])}else{if(o<w){w=o;n=[[t,s]]}}}}}}if(f===false&&d===false){if(r===false){r=true;v.medium=true;continue}return solveByGuessing(h,x,n,v)}}if(c){return null}else{return h}}function getZone(a){if(a<3){return 0}else{if(a<6){return 1}else{return 2}}}function reducePossibilities(g,l,c,h,b,f){var d=false;for(var e=0;e<9;e++){if(h[g[l][e]]||h[g[e][c]]){d=true}h[g[l][e]]=false;h[g[e][c]]=false}for(var j=b;j<=(b+2);j++){for(var i=f;i<=(f+2);i++){var a=g[j][i];if(h[a]){d=true}h[a]=false}}return d}function checkFreedoms(f,u,t,A,e,c){var p=0;var z=A[u][t];var d=z.slice(0);var b=z.slice(0);var o=z.slice(0);for(r=0;r<9;r++){for(var q=1;q<=9;q++){if(f[u][r]===0&&A[u][r][q]&&r!==t){d[q]=false}if(f[r][t]===0&&A[r][t][q]&&r!==u){b[q]=false}}}var v=0;var s=0;var n=0;var m=0;for(r=1;r<=9;r++){if(d[r]){v++;n=r}if(b[r]){s++;m=r}}if(v===1){p=n;return p}if(s===1){p=m;return p}for(var h=e;h<=(e+2);h++){for(var g=c;g<=(c+2);g++){for(q=1;q<=9;q++){if(f[h][g]===0&&A[h][g][q]&&(h!==u||g!==t)){o[q]=false}}}}var w=0;var a=0;for(var r=1;r<=9;r++){if(o[r]){w++;a=r}}if(w===1){p=a}return p}function solveByGuessing(g,a,b,e){if(b.length<1){return null}if("hard" in e){e.vhard=true}else{e.hard=true}var f=getRandom(b.length);var c=b[f];var j=[];var h=a[c[0]][c[1]];for(d=1;d<=9;d++){if(h[d]){j.push(d)}}shuffleArray(j);for(var d=0;d<j.length;++d){g[c[0]][c[1]]=j[d];var k=solveSudoku(g,e);if(k!==null){return k}}return null}function getRandom(a){return Math.floor(Math.random()*a)}function shuffleArray(d){var c=d.length;if(c!==0){while(--c){var b=Math.floor(Math.random()*(c+1));var a=d[c];d[c]=d[b];d[b]=a}}}(function(){var c=31337;var b=Math.random;var a=function(){var e=214013;var g=2531011;var d=4294967296;var f=(e*c+g)%d;c=f;return f/d};Math.enableFakeRandom=function(){Math.random=a};Math.disableFakeRandom=function(){Math.random=b};Math.fakeRandomSeed=function(d){c=d}})();function generatePuzzle(d){if(d!==1&&d!==2&&d!==3&&d!==4&&d!==5){d=1}var f=solveSudoku(emptyPuzzle);var g=new Array(81);for(e=0;e<81;e++){g[e]=e}shuffleArray(g);var c=81;for(var e=0;e<81;e++){if(c<=25){break}if(d===1&&c<=35){break}var h=g[e];var l=Math.floor(h/9);var b=h%9;var k=f[l][b];var a={};f[l][b]=0;var j=false;if(d<=2&&a.medium){j=true}else{if(d<=3&&a.hard){j=true}else{if(d<=4&&a.vhard){j=true}}}if(j){f[l][b]=k}else{c--}}return f}function verifySolution(g,f){var c={};c.valid=false;if(g===null){window.console&&console.log("Not a board");c.invalidBoard="Board was null";return c}var l=[];var k=[];var a=[[[],[],[]],[[],[],[]],[[],[],[]]];for(var e=0;e<9;e++){l.push([]);k.push([])}for(e=0;e<9;e++){for(var d=0;d<9;d++){var h=g[e][d];if(h===0){if(f){c.notFullySolved="Board still has unknowns";return c}else{continue}}if(h in l[e]){c.badRow=e;return c}else{l[e][h]=true}if(h in k[d]){c.badCol=d;return c}else{k[d][h]=true}var b=a[getZone(e)][getZone(d)];if(h in b){c.badCube=[getZone(e)*3,getZone(d)*3];return c}else{b[h]=true}}}c.valid=true;return c}var easyPuzzle=[[5,3,0,0,7,0,0,0,0],[6,0,0,1,9,5,0,0,0],[0,9,8,0,0,0,0,6,0],[8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,0,0,0,2,0,0,0,6],[0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9]];var easyPuzzle2=[[1,6,0,0,0,3,0,0,0],[2,0,0,7,0,6,0,1,4],[0,4,5,0,8,1,0,0,7],[5,0,8,4,0,0,0,0,0],[0,0,4,3,0,8,9,0,0],[0,0,0,0,0,7,2,0,8],[8,0,0,6,3,0,1,9,0],[6,3,0,1,0,5,0,0,2],[0,0,0,8,0,0,0,3,6]];var easyPuzzle3=[[8,1,0,0,2,9,0,0,0],[4,0,6,0,7,3,0,5,1],[0,7,0,0,0,0,8,0,2],[0,0,4,5,0,0,0,0,6],[7,6,0,0,0,0,0,1,3],[1,0,0,0,0,6,2,0,0],[2,0,7,0,0,0,0,8,0],[6,9,0,2,8,0,3,0,5],[0,0,0,9,6,0,0,2,4]];var solvedPuzzle=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[2,8,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]];var invalidPuzzle=[[5,3,4,6,7,8,9,1,2],[6,7,2,1,9,5,3,4,8],[1,9,8,3,4,2,5,6,7],[8,5,9,7,6,1,4,2,3],[4,2,6,8,5,3,7,9,1],[7,1,3,9,2,4,8,5,6],[9,6,1,5,3,7,2,8,4],[8,2,7,4,1,9,6,3,5],[3,4,5,2,8,6,1,7,9]];var hardPuzzle=[[0,0,3,0,0,8,0,0,0],[0,4,0,0,0,0,0,0,0],[0,8,0,3,5,0,9,0,0],[8,0,5,0,0,6,0,0,0],[1,0,0,7,3,2,0,0,8],[0,0,0,8,0,0,3,0,1],[0,0,8,0,1,4,0,7,0],[0,0,0,0,0,0,0,5,0],[0,0,0,9,0,0,2,0,0]];var mediumPuzzle=[[0,8,3,7,0,0,0,9,0],[0,0,7,0,5,0,6,4,0],[0,0,0,9,0,0,0,0,3],[0,0,0,1,0,0,0,0,7],[0,6,9,2,0,4,3,8,0],[7,0,0,0,0,9,0,0,0],[9,0,0,0,0,3,0,0,0],[0,5,6,0,2,0,4,0,0],[0,1,0,0,0,7,5,3,0]];var emptyPuzzle=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function verify(){this.value=isNaN(this.value)?"":this.value}function renderBoard(d){for(var b=0;b<9;b++){for(var a=0;a<9;a++){var g=""+b+a;var c=document.getElementById(g);var e=d[b][a];var f;if(e===0){f=document.createElement("input");f.setAttribute("maxlength",1);f.setAttribute("id","c"+b.toString()+a.toString());f.addEventListener("input",verify,false)}else{f=document.createElement("span");f.textContent=e}c.innerHTML="";c.setAttribute("class",((e===0)?"edit":"static")+"Value");c.setAttribute("tabIndex",0);c.appendChild(f)}}}function getCurrentBoard(){var d=new Array(9);for(var b=0;b<9;b++){for(var a=0;a<9;a++){if(a===0){d[b]=new Array(9)}var g=""+b+a;var c=document.getElementById(g);var f=c.children[0];var e="0";if(f.tagName==="INPUT"){e=f.value}else{if(f.tagName==="SPAN"){e=f.textContent}}if(e.match(/^[1-9]$/)){e=parseInt(e,10)}else{e=0}d[b][a]=e}}return d}function init(){var g,b,p,o,m,h;var a;document.getElementById("youWon").style.display="none";var d=generatePuzzle();renderBoard(d);var s=document.getElementById("amazeButton");var n=document.getElementById("calculating");var c=document.getElementById("finishedCalculating");var e=document.getElementById("youWon");var t=document.getElementById("noErrors");var u=document.getElementById("errorsFound");var r=document.getElementById("difficulty");var v=[];var f=false;var q=function(){u.style.display="none";t.style.display="none";for(var j=0;j<v.length;j++){v[j].setAttribute("class",v[j].getAttribute("class").replace(" error",""))}v=[]};s.addEventListener("click",function(){if(!f){var i=parseInt(r.options[r.selectedIndex].value,10);f=true;q();c.style.display="none";n.style.display="block";solveTest(i,function(){c.style.display="block";n.style.display="none";f=false;d=hardPuzzle})}},false);document.getElementById("checkButton").addEventListener("click",function(){q();var z=getCurrentBoard();var F=verifySolution(z);if(F.valid){var l=["LOOKIN GOOD","KEEP GOING","AWESOME","EXCELLENT","NICE","SWEET","LOOKS GOOD TO ME"];if(verifySolution(z,true)["valid"]){clock.stop(function(){a=false;var x=clock.getTime().time-1;document.getElementsByName("win")[0].value=1;document.getElementsByName("time")[0].value=x;e.innerHTML="Solved in "+parseInt(x/60,10)+" minutes "+(x%60)+" seconds."+e.innerHTML;e.style.display="block";document.getElementById("close").addEventListener("click",function(){e.style.display="none"},false);document.getElementById("new").addEventListener("click",function(){window.onbeforeunload=null;document.getElementById("hidden").click()},false)})}else{var w=getRandom(l.length);t.textContent=l[w];t.style.display="block"}}else{if("badRow" in F){var D=F.badRow;for(p=0;p<9;p++){i=""+D+p;j=document.getElementById(i);j.setAttribute("class",j.getAttribute("class")+" error");v.push(j)}}else{if("badCol" in F){var k=F.badCol;for(p=0;p<9;p++){i=""+p+k;j=document.getElementById(i);j.setAttribute("class",j.getAttribute("class")+" error");v.push(j)}}else{if("badCube" in F){var C=F.badCube[0];var E=F.badCube[1];for(var B=C+2;B>=C;B--){for(var A=E+2;A>=E;A--){var i=""+B+A;var j=document.getElementById(i);j.setAttribute("class",j.getAttribute("class")+" error");v.push(j)}}}}}u.style.display="block"}},false);document.getElementById("newGameButton").addEventListener("click",function(){if(!a){q();var i=parseInt(r.options[r.selectedIndex].value,10);d=generatePuzzle(i);renderBoard(d);a=true}else{window.location="/guest"}},false);addEventListener("mouseup",function(i){if(i.which===1){t.style.display="none"}},false)}addEventListener("DOMContentLoaded",init,false);